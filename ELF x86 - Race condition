For more explanation about the exploit, check out my blog

https://corruptedprotocol.medium.com/elf-x86-race-condition-rootme-app-system-d47124c2189
