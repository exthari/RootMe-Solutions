Here is a detailed explanation of the exploit 

https://corruptedprotocol.medium.com/elf-x64-stack-buffer-overflow-advanced-app-system-introduction-to-rop-x64-6bb39a1c4887
