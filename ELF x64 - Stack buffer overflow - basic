For more explanation about the exploit, check out my blog

https://corruptedprotocol.medium.com/elf-x64-stack-buffer-overflow-basic-rootme-app-system-35fc734ac5d0
